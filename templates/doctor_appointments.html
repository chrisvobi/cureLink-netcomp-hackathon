<!doctype html>
<html>
<head>
    <title>Doctor's Appointments</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/doctor_appointments.css') }}">
</head>
<body>
    <div class="container">
        <img src="{{ url_for('static', filename='images/Logo.png') }}" class="logo" alt="CureLink Logo">
        <h2>Your Past Appointments</h2>

        <div class="tables-container">
            {% if appointments %}
            <table class="appointments-table">
                <tr>
                    <th>Patient Name</th>
                    <th>Appointment Date & Time</th>
                    <th>Status</th>
                    <th>Diagnosis</th>
                    <th>Medicine</th>
                </tr>
                {% for appointment in appointments %}
                <tr>
                    <td>{{ appointment[0] }}</td>
                    <td>{{ appointment[1] }}</td>
                    <td>{{ appointment[2] }}</td>
                    <td>
                        {{ appointment[3] }}
                        {% if appointment[3] == 'None' %}
                        <button class="edit-btn" onclick="editDiagnosis(this)">Edit Diagnosis</button>
                        {% endif %}
                    </td>
                    <td>{{ appointment[4] }}</td>
                </tr>
                {% endfor %}
            </table>
            
            <table class="appointments-table">
                <tr>
                    <th>Patient Name</th>
                    <th>Appointment Date & Time</th>
                    <th>Status</th>
                    <th>Diagnosis</th>
                    <th>Medicine</th>
                </tr>
                {% for appointment in appointments %}
                <tr>
                    <td>{{ appointment[0] }}</td>
                    <td>{{ appointment[1] }}</td>
                    <td>{{ appointment[2] }}</td>
                    <td>
                        {{ appointment[3] }}
                        {% if appointment[3] == 'None' %}
                        <button class="edit-btn" onclick="editDiagnosis(this)">Edit Diagnosis</button>
                        {% endif %}
                    </td>
                    <td>{{ appointment[4] }}</td>
                </tr>
                {% endfor %}
            </table>
            {% else %}
            <p class="no-appointments">No appointments found.</p>
            {% endif %}
        </div>

        <!-- Κουμπί Give Feedback -->
        <button class="feedback-btn" onclick="toggleFeedback()">Give Feedback</button>

        <!-- Περιοχή για το Feedback (Αρχικά κρυφό) -->
        <div id="feedback-container" class="hidden">
            <textarea id="feedback-text" class="feedback-textbox" placeholder="Write your feedback here..."></textarea>
            <button class="submit-btn">Submit</button>
        </div>

        <br>
        <a class="action-button" href="{{ url_for('doctor_page') }}">Back to Doctor Page</a>
    </div>

    <script>
        function toggleFeedback() {
            var feedbackDiv = document.getElementById("feedback-container");
            feedbackDiv.classList.toggle("hidden");
        }

        function editDiagnosis(button) {
            var td = button.parentElement;
            var currentText = td.childNodes[0].nodeValue.trim();
            
            // Δημιουργία input πεδίου
            var input = document.createElement("input");
            input.type = "text";
            input.value = currentText;
            input.classList.add("edit-input");

            // Δημιουργία κουμπιού αποθήκευσης
            var saveBtn = document.createElement("button");
            saveBtn.innerText = "Save";
            saveBtn.classList.add("save-btn");
            saveBtn.onclick = function() {
                td.innerHTML = input.value; // Αποθήκευση της τιμής
            };

            // Καθαρισμός κελιού και προσθήκη input και save button
            td.innerHTML = "";
            td.appendChild(input);
            td.appendChild(saveBtn);
        }
    </script>
</body>
</html>
